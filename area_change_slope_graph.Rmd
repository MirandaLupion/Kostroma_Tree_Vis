---
title: "area_change_slope_graph"
author: "Miranda Lupion"
date: "12/31/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error = FALSE, message = FALSE, warning = FALSE)
library(readr)
library(tidyverse)
library(scales)
theme_set((theme_classic()))
area_change <- read_csv("area_change_1818_1908.csv")

```


```{r, labels and data frame}
years <- 90

# Select the data for year 1 (1818)

year_1 <- area_change %>%
  filter(year == 1818) %>%
  select(percent_forested)

# Select the data for year 2 (1908)

year_2 <- area_change %>%
  filter(year == 1908) %>%
  select(percent_forested)


# Only select one set of districts 
# This is made possible because R is preserving the order of all these observations 

groups <- area_change %>%
  filter(year == 1818) %>%
  select(district)

# Put the selected data together into a single data frame

slope_data <- data.frame(year_1, year_2, groups) %>%
  rename(year_1 = percent_forested, year_2 = percent_forested.1, groups = district)

# Create the labels for the graphic

l11 <- paste0(slope_data$groups, ", ", slope_data$year_1, "%")

l13<-paste0(slope_data$groups,", ", slope_data$year_2, "%")

```


```{r graphic}

ggplot(slope_data) + geom_segment(aes(x=0, xend = years, y = year_1, yend = year_2), size=.75) +
  theme(panel.background = element_blank()) +
  theme(panel.grid=element_blank()) +
  theme(axis.ticks=element_blank()) +
  theme(axis.text=element_blank()) +
  theme(panel.border=element_blank()) + 
  xlab("") + 
  ylab("Percent forested") + 
  xlim((0-20),(years+20)) +
  ylim(0,((max(slope_data$year_2,slope_data$year_1)))) +
  geom_text(label = l13,
            y = slope_data$year_2,
            x = years, hjust=-0.2,size=2) +
  geom_text(label = l11,
            y = slope_data$year_1,
            x = -25, hjust=-0.2,size=2)      


```


